<html>
  <head>
    <script type="text/javascript" src="https://npmcdn.com/parse/dist/parse.min.js"></script>
    <script>
      function navigateToGreetingPage() {
        window.location.href = "greeting.html";
      }
    </script>
  </head>
  <body>
    <div id="signin-signup">
      <h3>Sign In</h3>
      <form>
        <input type="email" id="emailSI" placeholder="Email">
        <br><br>
        <input type="password" id="passwordSI" placeholder="Password">
        <br><br>
        <button id="submitButtonSignIn">Sign In</button>
      </form>
      <p>Don't have an account? <a href="#" id="signup-link">Sign Up</a></p>
    </div>
    
    <!-- Sign-up Form -->
    <div id="signup" style="display:none;">
      <h3>Sign Up</h3>
      <form>
        <input id="username" type="text" placeholder="Username"/>
        <input id="email" type="email" placeholder="Email"/>
        <input id="password" type="password" placeholder="Password" />
        <button id="submitButtonSignUp">Sign Up</button>
      </form>
      <p>Already have an account? <a href="#" id="signin-link">Sign In</a></p>
    </div>
    
    <!-- JS for handling the Sign-in and Sign-up Forms -->
    <script>
      Parse.initialize("rgzBD2oDrFGwnP4GhepGqvLTb4zxUCVA8ISU94G6", "rbN8I2nlk462haH28HHxwAka3o02oVqWWz1PrFdi");
      Parse.serverURL = "https://parseapi.back4app.com/";
      
      async function signInUser() {
        try {
          const user = await Parse.User.logIn(document.getElementById("emailSI").value, document.getElementById("passwordSI").value);
          if (user !== null) {
            alert(`Successfully logged in as ${user.get("username")}`);
            await navigateToGreetingPage();
          }
        } catch (error) {
          alert(`Error: ${error.message}`);
        }
      }
      
      async function createParseUser() {
        let user = new Parse.User();

        user.set("username", document.getElementById("username").value);
        user.set("email", document.getElementById("email").value);
        user.set("password", document.getElementById("password").value);

        try {
          user = await user.save();
          
          if (user !== null) {
            await alert(`New object created with success! ObjectId: ${user.id}, ${user.get("username")}`);
            await navigateToGreetingPage();
          }
        } catch (error) {
          alert(`Error: ${error.message}`);
        }
      }

      // Show Sign-up Form when "Sign Up" is clicked
      document.getElementById("signup-link").addEventListener("click", function() {
        document.getElementById("signin-signup").style.display = "none";
        document.getElementById("signup").style.display = "block";
      });
    
    // Show Sign-in Form when "Sign In" is clicked
    document.getElementById("signin-link").addEventListener("click", function() {
      document.getElementById("signup").style.display = "none";
      document.getElementById("signin-signup").style.display = "block";
    });


        // // Add on click listener to call the create parse user function
        // document.getElementById("submitButtonSignUp").addEventListener("click", async function () {
        //   createParseUser();
        // });

        //         // Add on click listener to call the create parse user function
        // document.getElementById("submitButtonSignIn").addEventListener("click", async function () {
        //   signInUser();
        // });

        document.getElementById("submitButtonSignUp").addEventListener("click", async function(event) {
  event.preventDefault(); // prevent the form from submitting
  createParseUser();
});

document.getElementById("submitButtonSignIn").addEventListener("click", async function(event) {
  event.preventDefault(); // prevent the form from submitting
  signInUser();
});

  </script>


  </body>
</html>

